%校正后的单位阶跃响应(采用PID控制器)
wc=825;
A=0.0523;

Kp=0.6/A;
Ti=0.5*2*pi/wc;
t=0.125*2*pi/wc;
Kg=7;
Km=9;
num=[5400*Kg*Km*Kp*Ti*t,5400*Kg*Km*Kp*Ti,5400*Kg*Km*Kp];
den=[Ti,(11+0.62*Km+5400*Kg*Km*Kp*t)*Ti,(10+6.2*Km+5400*Kg*Km*Kp)*Ti,5400*Kg*Km*Kp];
sys=tf(num,den);
figure(1);
step(sys);
grid;
%根轨迹 Km从0变到无穷大，等效开环传递函数为
%Km[(0.62+5400*Kg*Kp*t)*Ti*s^2+(6.2+5400*Kg*Kp)*Ti*s+5400*Kg*Kp]/(Ti*s^3+11*Ti*s^2+10*Ti*s)
figure(2);
G=tf([(0.62+5400*Kg*Kp*t)*Ti,(6.2+5400*Kg*Kp)*Ti,5400*Kg*Kp],[Ti,11*Ti,10*Ti]);
rlocus(G);
grid;
%伯德图(开环与闭环)
GK=tf([5400*Kg*Km*Kp*Ti*t,5400*Kg*Km*Kp*Ti,5400*Kg*Km*Kp],[Ti,(11+0.62*Km)*Ti,(10+6.2*Km)*Ti,0]);
figure(3);
bode(GK);
title('开环对数幅频相频曲线');
grid;
figure(4);
bode(sys);
title('闭环对数幅频相频曲线');
grid;
