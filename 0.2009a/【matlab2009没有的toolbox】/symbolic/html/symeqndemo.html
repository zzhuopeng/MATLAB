
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
      <!--
This HTML is auto-generated from an M-file.
To make changes, update the M-file and republish this document.
      -->
      <title>Solving Equations</title>
      <meta name="generator" content="MATLAB 7.7">
      <meta name="date" content="2008-08-05">
      <meta name="m-file" content="symeqndemo">
      <link rel="stylesheet" type="text/css" href="../../matlab/demos/private/style.css">
   </head>
   <body>
      <div class="header">
         <div class="left"><a href="matlab:edit symeqndemo">Open symeqndemo.m in the Editor</a></div>
         <div class="right"><a href="matlab:echodemo symeqndemo">Run in the Command Window</a></div>
      </div>
      <div class="content">
         <h1>Solving Equations</h1>
         <!--introduction-->
         <!--/introduction-->
         <p>The "solve" and "dsolve" functions seek analytic solutions to algebraic and ordinary differential equations.</p>
         <p>The first example is a simple quadratic. You can either find the zeros of a symbolic expression, without quotes:</p><pre class="codeinput">syms <span class="string">a</span> <span class="string">b</span> <span class="string">c</span> <span class="string">x</span>
x = solve(a*x^2 + b*x + c);
</pre><p>Or, you can find the roots of an equation, given in quotes:</p><pre class="codeinput">x = solve(<span class="string">'a*x^2 + b*x + c = 0'</span>);
</pre><p>Both of these produce the same result:</p><pre class="codeinput">x
</pre><pre class="codeoutput"> 
x =
 
 -(b + (b^2 - 4*a*c)^(1/2))/(2*a)
 -(b - (b^2 - 4*a*c)^(1/2))/(2*a)
 
</pre><p>The solution to a general cubic is:</p><pre class="codeinput">x = solve(<span class="string">'a*x^3 + b*x^2 + c*x + d'</span>)

pretty(x)
</pre><pre class="codeoutput"> 
x =
 
                                                                                                                                                                                                                                                                                                                                                 ((c^3/(27*a^3) + d^2/(4*a^2) + (b^3*d)/(27*a^4) - (b^2*c^2)/(108*a^4) - (b*c*d)/(6*a^3))^(1/2) - d/(2*a) - b^3/(27*a^3) + (b*c)/(6*a^2))^(1/3) - b/(3*a) - (c/(3*a) - b^2/(9*a^2))/((c^3/(27*a^3) + d^2/(4*a^2) + (b^3*d)/(27*a^4) - (b^2*c^2)/(108*a^4) - (b*c*d)/(6*a^3))^(1/2) - d/(2*a) - b^3/(27*a^3) + (b*c)/(6*a^2))^(1/3)
 (c/(3*a) - b^2/(9*a^2))/(2*((c^3/(27*a^3) + d^2/(4*a^2) + (b^3*d)/(27*a^4) - (b^2*c^2)/(108*a^4) - (b*c*d)/(6*a^3))^(1/2) - d/(2*a) - b^3/(27*a^3) + (b*c)/(6*a^2))^(1/3)) - ((c^3/(27*a^3) + d^2/(4*a^2) + (b^3*d)/(27*a^4) - (b^2*c^2)/(108*a^4) - (b*c*d)/(6*a^3))^(1/2) - d/(2*a) - b^3/(27*a^3) + (b*c)/(6*a^2))^(1/3)/2 - b/(3*a) - (3^(1/2)*i*(((c^3/(27*a^3) + d^2/(4*a^2) + (b^3*d)/(27*a^4) - (b^2*c^2)/(108*a^4) - (b*c*d)/(6*a^3))^(1/2) - d/(2*a) - b^3/(27*a^3) + (b*c)/(6*a^2))^(1/3) + (c/(3*a) - b^2/(9*a^2))/((c^3/(27*a^3) + d^2/(4*a^2) + (b^3*d)/(27*a^4) - (b^2*c^2)/(108*a^4) - (b*c*d)/(6*a^3))^(1/2) - d/(2*a) - b^3/(27*a^3) + (b*c)/(6*a^2))^(1/3)))/2
 (c/(3*a) - b^2/(9*a^2))/(2*((c^3/(27*a^3) + d^2/(4*a^2) + (b^3*d)/(27*a^4) - (b^2*c^2)/(108*a^4) - (b*c*d)/(6*a^3))^(1/2) - d/(2*a) - b^3/(27*a^3) + (b*c)/(6*a^2))^(1/3)) - ((c^3/(27*a^3) + d^2/(4*a^2) + (b^3*d)/(27*a^4) - (b^2*c^2)/(108*a^4) - (b*c*d)/(6*a^3))^(1/2) - d/(2*a) - b^3/(27*a^3) + (b*c)/(6*a^2))^(1/3)/2 - b/(3*a) + (3^(1/2)*i*(((c^3/(27*a^3) + d^2/(4*a^2) + (b^3*d)/(27*a^4) - (b^2*c^2)/(108*a^4) - (b*c*d)/(6*a^3))^(1/2) - d/(2*a) - b^3/(27*a^3) + (b*c)/(6*a^2))^(1/3) + (c/(3*a) - b^2/(9*a^2))/((c^3/(27*a^3) + d^2/(4*a^2) + (b^3*d)/(27*a^4) - (b^2*c^2)/(108*a^4) - (b*c*d)/(6*a^3))^(1/2) - d/(2*a) - b^3/(27*a^3) + (b*c)/(6*a^2))^(1/3)))/2
 

array(1..3, 1..1,
  (1, 1) = ((1/27/a^3*c^3 + 1/4/a^2*d^2 + 1/27/a^4*b^3*d - 1/108/a^4*b^2*c^2\
 - 1/6/a^3*b*c*d)^(1/2) - 1/2/a*d - 1/27/a^3*b^3 + 1/6/a^2*b*c)^(1/3) - 1/3/\
a*b - (1/3/a*c - 1/9/a^2*b^2)/((1/27/a^3*c^3 + 1/4/a^2*d^2 + 1/27/a^4*b^3*d \
- 1/108/a^4*b^2*c^2 - 1/6/a^3*b*c*d)^(1/2) - 1/2/a*d - 1/27/a^3*b^3 + 1/6/a^\
2*b*c)^(1/3),
  (2, 1) = 1/2*(1/3/a*c - 1/9/a^2*b^2)/((1/27/a^3*c^3 + 1/4/a^2*d^2 + 1/27/a\
^4*b^3*d - 1/108/a^4*b^2*c^2 - 1/6/a^3*b*c*d)^(1/2) - 1/2/a*d - 1/27/a^3*b^3\
 + 1/6/a^2*b*c)^(1/3) - 1/2*((1/27/a^3*c^3 + 1/4/a^2*d^2 + 1/27/a^4*b^3*d - \
1/108/a^4*b^2*c^2 - 1/6/a^3*b*c*d)^(1/2) - 1/2/a*d - 1/27/a^3*b^3 + 1/6/a^2*\
b*c)^(1/3) - 1/3/a*b - 3^(1/2)*(((1/27/a^3*c^3 + 1/4/a^2*d^2 + 1/27/a^4*b^3*\
d - 1/108/a^4*b^2*c^2 - 1/6/a^3*b*c*d)^(1/2) - 1/2/a*d - 1/27/a^3*b^3 + 1/6/\
a^2*b*c)^(1/3) + (1/3/a*c - 1/9/a^2*b^2)/((1/27/a^3*c^3 + 1/4/a^2*d^2 + 1/27\
/a^4*b^3*d - 1/108/a^4*b^2*c^2 - 1/6/a^3*b*c*d)^(1/2) - 1/2/a*d - 1/27/a^3*b\
^3 + 1/6/a^2*b*c)^(1/3))*1/2*I,
  (3, 1) = 1/2*(1/3/a*c - 1/9/a^2*b^2)/((1/27/a^3*c^3 + 1/4/a^2*d^2 + 1/27/a\
^4*b^3*d - 1/108/a^4*b^2*c^2 - 1/6/a^3*b*c*d)^(1/2) - 1/2/a*d - 1/27/a^3*b^3\
 + 1/6/a^2*b*c)^(1/3) - 1/2*((1/27/a^3*c^3 + 1/4/a^2*d^2 + 1/27/a^4*b^3*d - \
1/108/a^4*b^2*c^2 - 1/6/a^3*b*c*d)^(1/2) - 1/2/a*d - 1/27/a^3*b^3 + 1/6/a^2*\
b*c)^(1/3) - 1/3/a*b + 3^(1/2)*(((1/27/a^3*c^3 + 1/4/a^2*d^2 + 1/27/a^4*b^3*\
d - 1/108/a^4*b^2*c^2 - 1/6/a^3*b*c*d)^(1/2) - 1/2/a*d - 1/27/a^3*b^3 + 1/6/\
a^2*b*c)^(1/3) + (1/3/a*c - 1/9/a^2*b^2)/((1/27/a^3*c^3 + 1/4/a^2*d^2 + 1/27\
/a^4*b^3*d - 1/108/a^4*b^2*c^2 - 1/6/a^3*b*c*d)^(1/2) - 1/2/a*d - 1/27/a^3*b\
^3 + 1/6/a^2*b*c)^(1/3))*1/2*I
)

</pre><p>The statement</p><pre class="codeinput">x = solve(<span class="string">'p*sin(x) = r'</span>);
</pre><p>chooses 'x' as the unknown and returns</p><pre class="codeinput">x
</pre><pre class="codeoutput"> 
x =
 
        asin(r/p)
 pi - asin(1/p*r)
 
</pre><p>A system of two quadratic equations in two unknowns produces solution vectors.</p><pre class="codeinput">[x,y] = solve(<span class="string">'x^2 + x*y + y = 3'</span>,<span class="string">'x^2 - 4*x + 3 = 0'</span>)
</pre><pre class="codeoutput"> 
x =
 
 1
 3
 
 
y =
 
    1
 -3/2
 
</pre><p>The solution can also be returned in a structure.</p><pre class="codeinput">S = solve(<span class="string">'x^2 + x*y + y = 3'</span>,<span class="string">'x^2 - 4*x + 3 = 0'</span>)
S.x
S.y
</pre><pre class="codeoutput">
S = 

    x: [2x1 sym]
    y: [2x1 sym]

 
ans =
 
 1
 3
 
 
ans =
 
    1
 -3/2
 
</pre><p>The next example regards 'a' as a parameter and solves two equations for u and v.</p><pre class="codeinput">[u,v] = solve(<span class="string">'a*u^2 + v^2 = 0'</span>,<span class="string">'u - v = 1'</span>)
</pre><pre class="codeoutput"> 
u =
 
 1 - (a + (-a)^(1/2))/(a + 1)
 1 - (a - (-a)^(1/2))/(a + 1)
 
 
v =
 
 -(a + (-a)^(1/2))/(a + 1)
 -(a - (-a)^(1/2))/(a + 1)
 
</pre><p>Add a third equation and solve for all three unknowns.</p><pre class="codeinput">[a,u,v] = solve(<span class="string">'a*u^2 + v^2'</span>,<span class="string">'u - v = 1'</span>,<span class="string">'a^2 - 5*a + 6'</span>)
</pre><pre class="codeoutput"> 
a =
 
 3
 2
 2
 3
 
 
u =
 
 (3^(1/2)*i)/4 + 1/4
 (2^(1/2)*i)/3 + 1/3
 1/3 - (2^(1/2)*i)/3
 1/4 - (3^(1/2)*i)/4
 
 
v =
 
   (3^(1/2)*i)/4 - 3/4
   (2^(1/2)*i)/3 - 2/3
 - (2^(1/2)*i)/3 - 2/3
 - (3^(1/2)*i)/4 - 3/4
 
</pre><p>If an analytic solution cannot be found, "solve" returns a numeric solution.</p><pre class="codeinput">digits(32)
[x,y] = solve(<span class="string">'sin(x+y)-exp(x)*y = 0'</span>,<span class="string">'x^2-y = 2'</span>)
</pre><pre class="codeoutput"> 
x =
 
-0.66870120500236202933135901833637
 
 
y =
 
-1.5528386984283889912797441811191
 
</pre><p>Similar notation, with "D" denoting differentiation, is used for for ordinary differential equations by the "dsolve" function.</p><pre class="codeinput">y = dsolve(<span class="string">'Dy = -a*y'</span>)
</pre><pre class="codeoutput"> 
y =
 
C5/exp(a*t)
 
</pre><p>Specify an initial condition.</p><pre class="codeinput">y = dsolve(<span class="string">'Dy = -a*y'</span>,<span class="string">'y(0) = 1'</span>)
</pre><pre class="codeoutput"> 
y =
 
1/exp(a*t)
 
</pre><p>The second derivative is denoted by "D2'.</p><pre class="codeinput">y = dsolve(<span class="string">'D2y = -a^2*y'</span>, <span class="string">'y(0) = 1, Dy(pi/a) = 0'</span>)
</pre><pre class="codeoutput"> 
y =
 
cos(a*t)
 
</pre><p>A nonlinear equation produces two solutions in a vector.</p><pre class="codeinput">y = dsolve(<span class="string">'(Dy)^2 + y^2 = 1'</span>,<span class="string">'y(0) = 0'</span>)
</pre><pre class="codeoutput"> 
y =
 
 piecewise([Re(C20) in [-1/2*pi, 1/2*pi] and C20 in {k*pi | k in Z_} and t + Re(C20) in [-1/2*pi, 1/2*pi], sin(C20 + t)])
                                 {sin(- t + l*pi) | l in Z_ intersect solve(Re(k) in [-(pi/2 - t)/pi, (pi/2 + t)/pi], k)}
 
</pre><p class="footer">Copyright 1993-2006 The MathWorks, Inc.<br>
            Published with MATLAB&reg; 7.7
         </p>
         <p class="footer" id="trademarks">MATLAB and Simulink are registered trademarks of The MathWorks, Inc.  Please see <a href="http://www.mathworks.com/trademarks">www.mathworks.com/trademarks</a> for a list of other trademarks owned by The MathWorks, Inc.  Other product or brand names are trademarks or registered trademarks
            of their respective owners.
         </p>
      </div>
      <!--
##### SOURCE BEGIN #####
%% Solving Equations
%
%  Copyright 1993-2006 The MathWorks, Inc.
%  $Revision: 1.8.4.5 $  $Date: 2007/08/03 21:43:27 $

%%
% The "solve" and "dsolve" functions seek analytic solutions
% to algebraic and ordinary differential equations.

%%
%
% The first example is a simple quadratic.
% You can either find the zeros of a symbolic expression, without quotes:

syms a b c x
x = solve(a*x^2 + b*x + c);

%%
%
% Or, you can find the roots of an equation, given in quotes:

x = solve('a*x^2 + b*x + c = 0');

%%
%
% Both of these produce the same result:

x

%%
% The solution to a general cubic is:

x = solve('a*x^3 + b*x^2 + c*x + d')

pretty(x)

%%
% The statement

x = solve('p*sin(x) = r');

%%
%
% chooses 'x' as the unknown and returns

x

%%
% A system of two quadratic equations in two unknowns produces solution vectors.

[x,y] = solve('x^2 + x*y + y = 3','x^2 - 4*x + 3 = 0')

%%
% The solution can also be returned in a structure.

S = solve('x^2 + x*y + y = 3','x^2 - 4*x + 3 = 0')
S.x
S.y

%%
% The next example regards 'a' as a parameter and solves two
% equations for u and v.

[u,v] = solve('a*u^2 + v^2 = 0','u - v = 1')

%%
% Add a third equation and solve for all three unknowns.

[a,u,v] = solve('a*u^2 + v^2','u - v = 1','a^2 - 5*a + 6')

%%
% If an analytic solution cannot be found, "solve" returns a numeric solution.

digits(32)
[x,y] = solve('sin(x+y)-exp(x)*y = 0','x^2-y = 2')

%%
% Similar notation, with "D" denoting differentiation, is used for
% for ordinary differential equations by the "dsolve" function.

y = dsolve('Dy = -a*y')

%%
% Specify an initial condition.

y = dsolve('Dy = -a*y','y(0) = 1')

%%
% The second derivative is denoted by "D2'.

y = dsolve('D2y = -a^2*y', 'y(0) = 1, Dy(pi/a) = 0')

%%
% A nonlinear equation produces two solutions in a vector.

y = dsolve('(Dy)^2 + y^2 = 1','y(0) = 0')


displayEndOfDemoMessage(mfilename)

##### SOURCE END #####
-->
   </body>
</html>